#!/bin/sh
NAME="tracker3"
RELEASE="1"
VERSION="3.5.3"
SOURCES="https://gitlab.gnome.org/GNOME/tracker/-/archive/$VERSION/tracker-$VERSION.tar.gz"
DEPENDS="glib libxml2 libsoup sqlite dbus json-glib libseccomp"
BUILD_DEPENDS="meson vala gobject-introspection pygobject"
SHA256SUM="cdc142383b9c64a2a57b04fff9bcf4f154c1b1a03b5529b02546d936d1c46205"
DESCRIPTION="An efficient search engine and triplestore for desktop, embedded and mobile"

build() {
    
    if ! command -v systemctl > /dev/null; then
        extraArgs="-Dsystemd_user_services=false"
    fi

    rm -rf subprojects/gvdb
    git clone https://gitlab.gnome.org/GNOME/gvdb.git subprojects/gvdb

    meson setup $extraArgs \
    --prefix=/usr \
    --buildtype=release \
    -Dman=false \
    -Ddocs=false \
    build
    ninja -C build
}

package() {
    DESTDIR="$ROOT" ninja -C build install
}
