name: "docbook-xsl"
version: "1.79.2"
release: "1"
description: "XML stylesheets for Docbook-xml transformations"
sources:
  - "https://github.com/docbook/xslt10-stylesheets/releases/download/release/$version/docbook-xsl-$version.tar.bz2"
sha256sum:
  - "316524ea444e53208a2fb90eeb676af755da96e1417835ba5f5eb719c81fa371"
depends:
  - "libxml2"
  - "libxslt"
  - "docbook-xml"

package {

  exec "install -v -m755 -d $ROOT/usr/share/xml/docbook/xsl-stylesheets-$version"

  exec "cp -v -R VERSION assembly common eclipse epub epub3 extensions fo        highlighting html htmlhelp images javahelp lib manpages params   profiling roundtrip slides template tests tools webhelp website  xhtml xhtml-1_1 xhtml5                                           $ROOT/usr/share/xml/docbook/xsl-stylesheets-$version"

  exec "ln -s VERSION $ROOT/usr/share/xml/docbook/xsl-stylesheets-$version/VERSION.xsl"

  exec "install -v -m644 -D README  $ROOT/usr/share/doc/docbook-xsl-$version/README.txt"
  exec "install -v -m644    RELEASE-NOTES* NEWS*  $ROOT/usr/share/doc/docbook-xsl-$version"
  exec "rm -f $ROOT/etc/xml/docbook"
}

postinstall {
  if ${exec("test -d /etc/xml")}.exit() != 0 {
    exec "install -v -m755 -d /etc/xml"
  }
  if ${exec("test -f /etc/xml/catalog")}.exit() != 0 {
    exec "xmlcatalog --noout --create /etc/xml/catalog"
  }

  exec "xmlcatalog --noout --add \"rewriteSystem\"  \"http://docbook.sourceforge.net/release/xsl/1.79.2\"  \"/usr/share/xml/docbook/xsl-stylesheets-1.79.2\"  /etc/xml/catalog"

  exec "xmlcatalog --noout --add \"rewriteURI\"  \"http://docbook.sourceforge.net/release/xsl/1.79.2\"  \"/usr/share/xml/docbook/xsl-stylesheets-1.79.2\"  /etc/xml/catalog"

  exec "xmlcatalog --noout --add \"rewriteSystem\"  \"http://docbook.sourceforge.net/release/xsl/current\"  \"/usr/share/xml/docbook/xsl-stylesheets-1.79.2\"  /etc/xml/catalog"

  exec "xmlcatalog --noout --add \"rewriteURI\"  \"http://docbook.sourceforge.net/release/xsl/current\"  \"/usr/share/xml/docbook/xsl-stylesheets-1.79.2\"  /etc/xml/catalog"
}

